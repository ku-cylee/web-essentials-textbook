\usepackage{amsthm}
\usepackage{xcolor}
\usepackage{mdframed}

\definecolor{codebgcolor}{HTML}{E7E7E7}

\mdfdefinestyle{codeframe}{
    hidealllines=true,
    backgroundcolor=codebgcolor,
    skipabove=15pt,
    innertopmargin=-3pt,
    innerbottommargin=8pt,
}

\makeatletter
\def\thmhead@plain#1#2#3{%
    \thmname{#1}\thmnumber{\@ifnotempty{#1}{ }\@upn{#2}}%
    \thmnote{ {\the\thm@notefont#3}}}
\let\thmhead\thmhead@plain
\makeatother

\newtheoremstyle{codestyle}% name of the style to be used
    {20pt}% measure of space to leave above the theorem. E.g.: 3pt
    {}% measure of space to leave below the theorem. E.g.: 3pt
    {}% name of font to use in the body of the theorem
    {}% measure of space to indent
    {\bfseries}% name of head font
    {}% punctuation between head and body
    {0pt}% space after theorem head
    {}% Manually specify head
\theoremstyle{codestyle}
\newtheorem{code}{Code}[chapter]

\newenvironment{codeenv}[2]
    {\begin{mdframed}[style=codeframe]\begin{code}[#2]\label{#1}\linespread{1.0}{\ }}
    {\end{code}\end{mdframed}}
